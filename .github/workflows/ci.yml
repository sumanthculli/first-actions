  name: Actions CI
  on:
    pull_request:
      branches: [develop]
    push:
      branches: [develop]
  jobs:
    build: 
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2
        - name: Cache node mdoules
          uses: actions/cache@v1
          with:
           path: ~/.npm
           key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
           restore-keys: |
             ${{ runner.os }}-node-
        - name: Use Node jobs
          uses: actions/setup-node@v1
          with:
            node-version: "12.x"
        - run: npm ci
        - run: npm test -- --coverage
          env:
            ci : true
        - name: upload artifact
          uses: actions/upload-artifact@v1
          with:
            path: coverage
            name: code-coverage
        - name: On build 
          if: github.event_name == 'push'
          run: npm run build     
        - name: upload build
          if: github.event_name == 'push'
          uses: actions/upload-artifact@v1
          with:
            name: build
            path: build   
